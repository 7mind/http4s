<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../assets/ico/favicon.ico">

    <title>http4s</title>

    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.css" rel="stylesheet">

    <link href="css/syntax.css" rel="stylesheet">
    <link href="css/http4s.css" rel="stylesheet">
    

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">http4s</a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-gears"></i> Scaladoc <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="http://http4s.org/api/0.7">0.7 (snapshot)</a></li>
                <li><a href="http://http4s.org/api/0.6">0.6 (release)</a></li>
                <li><a href="http://http4s.org/api/0.5">0.5 (release)</a></li>
                <li><a href="http://http4s.org/api/0.4">0.4 (release)</a></li>
                <li><a href="http://http4s.org/api/0.3">0.3 (release)</a></li>
                <li><a href="http://http4s.org/api/0.2">0.2 (release)</a></li>
                <li><a href="http://http4s.org/api/0.1">0.1 (release)</a></li>
              </ul>
            </li>
            <li><a href="http://github.com/http4s/http4s"><i class="fa fa-github"></i> GitHub</a></li>
            <li><a href="community.html"><i class="fa fa-users"></i> Community</a></li>
            <li><a href="http://demo.http4s.org/#/home"><i class="fa fa-eye"></i> Demo</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      <h1>http4s</h1>

      <p>http4s is a minimal, idiomatic Scala interface for HTTP.  http4s is Scala&#39;s answer to Ruby&#39;s 
Rack, Python&#39;s WSGI, Haskell&#39;s WAI, and Java&#39;s Servlets.</p>

<h2 id="toc_0">HttpService</h2>

<p>An <code>HttpService</code> transforms a <code>Request</code> into an asynchronous <code>Task[Response]</code>. http4s provides a variety
of helpers to facilitate the creation of the <code>Task[Response]</code> from common results.</p>

<p>HttpServices are <em>type safe</em>, <em>composable</em>, and <em>asynchronous</em>.</p>

<h3 id="toc_1">Type safety</h3>

<p><code>Request</code> and <code>Response</code> sit at the top level of a typed, immutable model of HTTP.</p>

<ul>
<li>Well-known headers are lazily parsed into a rich model derived from Spray HTTP.</li>
<li>Bodies are parsed and generated from a <a href="http://github.com/scalaz/scalaz-stream">scalaz-stream</a> of bytes.</li>
</ul>

<h3 id="toc_2">Composable</h3>

<p>Building on the FP tools of scalaz not only makes an <code>HttpService</code> simple to define,
it also makes them easy to compose.  Adding gzip compression or rewriting URIs is
as simple as applying a middleware to an <code>HttpService</code>.</p>
<div class="highlight"><pre><code class="scala language-scala" data-lang="scala"><span class="k">val</span> <span class="n">wcompression</span> <span class="k">=</span> <span class="n">middleware</span><span class="o">.</span><span class="nc">GZip</span><span class="o">(</span><span class="n">service</span><span class="o">)</span>
<span class="k">val</span> <span class="n">translated</span>   <span class="k">=</span> <span class="n">middleware</span><span class="o">.</span><span class="nc">URITranslation</span><span class="o">.</span><span class="n">translateRoot</span><span class="o">(</span><span class="s">&quot;/http4s&quot;</span><span class="o">)(</span><span class="n">service</span><span class="o">)</span>
</code></pre></div>
<h3 id="toc_3">Asynchronous</h3>

<p>Any http4s response can be streamed from an asynchronous source. http4s offers a variety
of helpers to help you get your data out the door in the fastest way possible without
tying up too many threads.</p>
<div class="highlight"><pre><code class="scala language-scala" data-lang="scala"><span class="c1">// Make your model safe and streaming by using a scalaz-stream Process</span>
<span class="k">def</span> <span class="n">getData</span><span class="o">(</span><span class="n">req</span><span class="k">:</span> <span class="kt">Request</span><span class="o">)</span><span class="k">:</span> <span class="kt">Process</span><span class="o">[</span><span class="kt">Task</span>, <span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">???</span>

<span class="k">val</span> <span class="n">service</span> <span class="k">=</span> <span class="nc">HttpService</span> <span class="o">{</span>
  <span class="c1">// Wire your data into your service</span>
  <span class="k">case</span> <span class="nc">GET</span> <span class="o">-&gt;</span> <span class="nc">Root</span> <span class="o">/</span> <span class="s">&quot;streaming&quot;</span> <span class="k">=&gt;</span> <span class="nc">Ok</span><span class="o">(</span><span class="n">getData</span><span class="o">(</span><span class="n">req</span><span class="o">))</span>

  <span class="c1">// You can use helpers to send any type of data with an available EntityEncoder[T]</span>
  <span class="k">case</span> <span class="nc">GET</span> <span class="o">-&gt;</span> <span class="nc">Root</span> <span class="o">/</span> <span class="s">&quot;synchronous&quot;</span> <span class="k">=&gt;</span> <span class="nc">Ok</span><span class="o">(</span><span class="s">&quot;This is good to go right now.&quot;</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div>
<p>http4s is a forward-looking technology.  HTTP/2.0 and WebSockets will play a central role.</p>
<div class="highlight"><pre><code class="scala language-scala" data-lang="scala"><span class="k">val</span> <span class="n">route</span> <span class="k">=</span> <span class="nc">HttpService</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">req</span><span class="k">@</span> <span class="nc">GET</span> <span class="o">-&gt;</span> <span class="nc">Root</span> <span class="o">/</span> <span class="s">&quot;ws&quot;</span> <span class="k">=&gt;</span>
    <span class="c1">// Send a Text message with payload &#39;Ping!&#39; every second</span>
    <span class="k">val</span> <span class="n">src</span> <span class="k">=</span> <span class="nc">Process</span><span class="o">.</span><span class="n">awakeEvery</span><span class="o">(</span><span class="mf">1.</span><span class="n">seconds</span><span class="o">).</span><span class="n">map</span><span class="o">{</span> <span class="n">d</span> <span class="k">=&gt;</span> <span class="nc">Text</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;Ping! $d&quot;</span><span class="o">)</span> <span class="o">}</span>

    <span class="c1">// Print received Text frames, and, on completion, notify the console</span>
    <span class="k">val</span> <span class="n">sink</span><span class="k">:</span> <span class="kt">Sink</span><span class="o">[</span><span class="kt">Task</span>, <span class="kt">WSFrame</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Process</span><span class="o">.</span><span class="n">constant</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">Text</span><span class="o">(</span><span class="n">t</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Task</span><span class="o">.</span><span class="n">delay</span><span class="o">(</span><span class="n">println</span><span class="o">(</span><span class="n">t</span><span class="o">))</span>
      <span class="k">case</span> <span class="n">f</span>       <span class="k">=&gt;</span> <span class="nc">Task</span><span class="o">.</span><span class="n">delay</span><span class="o">(</span><span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">&quot;Unknown type: $f&quot;</span><span class="o">))</span>
    <span class="o">}.</span><span class="n">onComplete</span><span class="o">(</span><span class="nc">Process</span><span class="o">.</span><span class="n">eval</span><span class="o">(</span><span class="nc">Task</span><span class="o">{</span> <span class="n">println</span><span class="o">(</span><span class="s">&quot;Terminated!&quot;</span><span class="o">)}).</span><span class="n">drain</span><span class="o">)</span>

    <span class="c1">// Use the WS helper to make the Task[Response] carrying the info</span>
    <span class="c1">// needed for the backend to upgrade to a WebSocket connection</span>
    <span class="nc">WS</span><span class="o">(</span><span class="n">src</span><span class="o">,</span> <span class="n">sink</span><span class="o">)</span>

  <span class="k">case</span> <span class="n">req</span> <span class="k">@</span> <span class="nc">GET</span> <span class="o">-&gt;</span> <span class="nc">Root</span> <span class="o">/</span> <span class="s">&quot;wsecho&quot;</span> <span class="k">=&gt;</span>
    <span class="c1">// a scalaz topic acts as a hub to publish and subscribe to messages safely</span>
    <span class="k">val</span> <span class="n">t</span> <span class="k">=</span> <span class="n">topic</span><span class="o">[</span><span class="kt">WSFrame</span><span class="o">]</span>
    <span class="k">val</span> <span class="n">src</span> <span class="k">=</span> <span class="n">t</span><span class="o">.</span><span class="n">subscribe</span><span class="o">.</span><span class="n">collect</span><span class="o">{</span> <span class="k">case</span> <span class="nc">Text</span><span class="o">(</span><span class="n">msg</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Text</span><span class="o">(</span><span class="s">&quot;You sent the server: &quot;</span> <span class="o">+</span> <span class="n">msg</span><span class="o">)</span> <span class="o">}</span>
    <span class="nc">WS</span><span class="o">(</span><span class="n">src</span><span class="o">,</span> <span class="n">t</span><span class="o">.</span><span class="n">publish</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div>
<h2 id="toc_4">Choose your backend</h2>

<p>http4s supports running the same service on multiple backends.  Pick the deployment model that fits your 
needs now, and easily port if and when your needs change.</p>

<h3 id="toc_5">blaze</h3>

<p><a href="http://github.com/http4s/blaze">blaze</a> is an NIO framework.  Run http4s on blaze for maximum throughput.</p>

<pre><code class="language-Rouge::Lexers::Scala" data-lang="Rouge::Lexers::Scala"><code class="highlight"><span class="k">import</span> <span class="nn">com.example.http4s.ExampleService</span>
<span class="n">mport</span> <span class="n">org</span><span class="o">.</span><span class="n">http4s</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">blaze</span><span class="o">.</span><span class="nc">BlazeBuilder</span>

<span class="n">bject</span> <span class="nc">BlazeExample</span> <span class="k">extends</span> <span class="nc">App</span> <span class="o">{</span>
 <span class="nc">BlazeBuilder</span><span class="o">.</span><span class="n">bindHttp</span><span class="o">(</span><span class="mi">8080</span><span class="o">)</span>
   <span class="o">.</span><span class="n">mountService</span><span class="o">(</span><span class="nc">ExampleService</span><span class="o">.</span><span class="n">service</span><span class="o">,</span> <span class="s">"/http4s"</span><span class="o">)</span>
   <span class="o">.</span><span class="n">run</span>
   <span class="o">.</span><span class="n">awaitShutdown</span><span class="o">()</span>
</code></code></pre>

<h3 id="toc_6">Servlets</h3>

<p>http4s is committed to first-class support of the Servlet API.  Develop and deploy services 
on your existing infrastructure, and take full advantage of the mature JVM ecosystem.
http4s can run in a .war on any Servlet 3.0+ container, and comes with convenient builders
for embedded Tomcat and Jetty containers.</p>

<pre><code class="language-Rouge::Lexers::Scala" data-lang="Rouge::Lexers::Scala"><code class="highlight">
<span class="k">object</span> <span class="nc">JettyExample</span> <span class="k">extends</span> <span class="nc">App</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">metrics</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MetricRegistry</span>

  <span class="nc">JettyBuilder</span>
    <span class="o">.</span><span class="n">bindHttp</span><span class="o">(</span><span class="mi">8080</span><span class="o">)</span>
    <span class="o">.</span><span class="n">withMetricRegistry</span><span class="o">(</span><span class="n">metrics</span><span class="o">)</span>
    <span class="o">.</span><span class="n">mountService</span><span class="o">(</span><span class="nc">ExampleService</span><span class="o">.</span><span class="n">service</span><span class="o">,</span> <span class="s">"/http4s"</span><span class="o">)</span>
    <span class="o">.</span><span class="n">mountServlet</span><span class="o">(</span><span class="k">new</span> <span class="nc">MetricsServlet</span><span class="o">(</span><span class="n">metrics</span><span class="o">),</span> <span class="s">"/metrics/*"</span><span class="o">)</span>
    <span class="o">.</span><span class="n">run</span>
    <span class="o">.</span><span class="n">awaitShutdown</span><span class="o">()</span>
<span class="o">}</span>
</code></code></pre>

<h2 id="toc_7">An Asynchronous Client</h2>

<p>http4s also offers an asynchronous HTTP client built on the same model as the server.</p>

<pre><code class="language-Rouge::Lexers::Scala" data-lang="Rouge::Lexers::Scala"><code class="highlight"><span class="k">import</span> <span class="nn">org.http4s.Http4s._</span>
<span class="k">import</span> <span class="nn">scalaz.concurrent.Task</span>

<span class="k">val</span> <span class="n">client</span> <span class="k">=</span> <span class="n">org</span><span class="o">.</span><span class="n">http4s</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">blaze</span><span class="o">.</span><span class="n">defaultClient</span>

<span class="k">val</span> <span class="n">page</span><span class="k">:</span> <span class="kt">Task</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">client</span><span class="o">(</span><span class="n">uri</span><span class="o">(</span><span class="s">"https://www.google.com/"</span><span class="o">)).</span><span class="n">as</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>

<span class="n">println</span><span class="o">(</span><span class="n">page</span><span class="o">.</span><span class="n">run</span><span class="o">)</span>   <span class="c1">// each execution of the Task will refetch the page!
</span><span class="n">println</span><span class="o">(</span><span class="n">page</span><span class="o">.</span><span class="n">run</span><span class="o">)</span>

<span class="c1">// We can do much more: how about decoding some JSON to a scala object
// after matching based on the response status code?
</span><span class="k">import</span> <span class="nn">org.http4s.Status.NotFound</span>
<span class="k">import</span> <span class="nn">org.http4s.Status.ResponseClass.Successful</span>
<span class="k">import</span> <span class="nn">argonaut.DecodeJson</span>
<span class="k">import</span> <span class="nn">org.http4s.argonaut.jsonOf</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Foo</span><span class="o">(</span><span class="n">bar</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">fooDecode</span> <span class="k">=</span> <span class="nc">DecodeJson</span><span class="o">(</span><span class="n">c</span> <span class="k">=&gt;</span> <span class="k">for</span> <span class="o">{</span> <span class="c1">// Argonaut decoder. Could also use json4s.
</span>  <span class="n">bar</span> <span class="k">&lt;-</span> <span class="o">(</span><span class="n">c</span> <span class="o">--\</span> <span class="s">"bar"</span><span class="o">).</span><span class="n">as</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
<span class="o">}</span> <span class="k">yield</span> <span class="nc">Foo</span><span class="o">(</span><span class="n">bar</span><span class="o">))</span>

<span class="c1">// jsonOf is defined for Json4s and Argonaut, just need the right decoder!
</span><span class="k">implicit</span> <span class="k">val</span> <span class="n">foDecoder</span> <span class="k">=</span> <span class="n">jsonOf</span><span class="o">[</span><span class="kt">Foo</span><span class="o">]</span>

<span class="c1">// Match on response code!
</span><span class="k">val</span> <span class="n">page2</span> <span class="k">=</span> <span class="n">client</span><span class="o">(</span><span class="n">uri</span><span class="o">(</span><span class="s">"https://twitter.com/doesnt_exist"</span><span class="o">)).</span><span class="n">flatMap</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">Successful</span><span class="o">(</span><span class="n">resp</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">resp</span><span class="o">.</span><span class="n">as</span><span class="o">[</span><span class="kt">Foo</span><span class="o">].</span><span class="n">map</span><span class="o">(</span><span class="s">"Received response: "</span> <span class="o">+</span> <span class="k">_</span><span class="o">)</span>
  <span class="k">case</span> <span class="nc">NotFound</span><span class="o">(</span><span class="n">resp</span><span class="o">)</span>   <span class="k">=&gt;</span> <span class="nc">Task</span><span class="o">.</span><span class="n">now</span><span class="o">(</span><span class="s">"Not Found!!!"</span><span class="o">)</span>
  <span class="k">case</span> <span class="n">resp</span>             <span class="k">=&gt;</span> <span class="nc">Task</span><span class="o">.</span><span class="n">now</span><span class="o">(</span><span class="s">"Failed: "</span> <span class="o">+</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="o">)</span>
<span class="o">}</span>

<span class="n">println</span><span class="o">(</span><span class="n">page2</span><span class="o">.</span><span class="n">run</span><span class="o">)</span></code></code></pre>

<h2 id="toc_8">Projects using http4s</h2>

<p>If you have a project you would like to include in this list, let us know on IRC or submit an issue.</p>

<ul>
<li><a href="http://httpize.herokuapp.com/">httpize</a>: a <a href="http://httpbin.org/">httpbin</a> built with http4s</li>
<li><a href="https://github.com/http4s/rho">Project ρ</a>: a self-documenting HTTP server DSL built upon http4s</li>
<li><a href="https://github.com/beloglazov/couchdb-scala">CouchDB-Scala</a>: a purely functional Scala client for CouchDB</li>
</ul>

<h2 id="toc_9">Get it!</h2>

<p>Artifacts for scala 2.10 and 2.11 are available from Maven Central:
<code>scala
libraryDependencies += &quot;org.http4s&quot; %% &quot;http4s-blazeserver&quot;  % version  // to use the blaze backend
libraryDependencies += &quot;org.http4s&quot; %% &quot;http4s-servlet&quot;      % version  // to use the raw servlet backend
libraryDependencies += &quot;org.http4s&quot; %% &quot;http4s-jetty&quot;        % version  // to use the jetty servlet backend
libraryDependencies += &quot;org.http4s&quot; %% &quot;http4s-blazeclient&quot;  % version  // to use the blaze client
</code></p>

<p>Snapshots for the development branch are available in the sonatype snapshots repos.</p>

<p>To get scalaz-stream artifacts, you will probably need to add BinTray to your resolvers:
<code>scala
resolvers += &quot;Scalaz Bintray Repo&quot; at &quot;http://dl.bintray.com/scalaz/releases&quot;
</code></p>

<h2 id="toc_10">Build &amp; run</h2>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nv">$ </span>git clone https://github.com/http4s/http4s.git
<span class="nv">$ </span><span class="nb">cd </span>http4s
<span class="nv">$ </span>sbt examples-blaze/run
</code></pre></div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  </body>
</html>

